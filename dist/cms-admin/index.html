<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Maxnate CMS</title>
  <link href="config.yml" type="text/yaml" rel="cms-config-url">
  <!-- Netlify Identity Widget -->
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  
  <!-- Custom styling for Identity widget -->
  <style>
    /* Force teal color scheme globally */
    :root {
      --accent-color: #008080 !important;
    }
    
    /* Style the CMS logo to be prominent */
    img[src*="cms-01.png"],
    img[alt="Logo"],
    header img,
    [class*="header"] img {
      max-height: 50px !important;
      height: 50px !important;
      width: auto !important;
      display: block !important;
      margin: 10px !important;
    }
    
    /* Customize the login modal - Netlify Identity */
    div[class*="netlify"] {
      --accent-color: #008080;
      --border-radius: 8px;
    }
    
    /* Hide ALL Netlify branding */
    a[href*="netlify.com"],
    img[alt*="Netlify"],
    [class*="Provider"] img[alt="Netlify"],
    div[class*="footer"]:has(a[href*="netlify"]) {
      display: none !important;
    }
    
    /* Style buttons with teal */
    button,
    .btn,
    [type="submit"],
    a[class*="btn"],
    button[class*="button"] {
      background-color: #008080 !important;
      border-color: #008080 !important;
    }
    
    button:hover,
    .btn:hover,
    [type="submit"]:hover {
      background-color: #020202 !important;
      border-color: #020202 !important;
    }
    
    /* Inject "Powered by Maxnate" into any modal footer */
    div[class*="modal"] > div:last-child::after,
    form::after {
      content: "Powered by Maxnate" !important;
      display: block !important;
      text-align: center !important;
      padding: 12px !important;
      font-size: 12px !important;
      color: #008080 !important;
      font-weight: 500 !important;
      margin-top: 10px !important;
      border-top: 1px solid #e0e0e0 !important;
    }
    /* Overlay & refined login card styles */
    .login-overlay { display:none; position:fixed; inset:0; background:linear-gradient(135deg,#006666 0%,#008080 100%); z-index:9999; justify-content:center; align-items:center; padding:24px; animation:overlayFade .4s ease both; }
    .login-card { background:#fff; padding:40px 36px 32px; width:100%; max-width:400px; border-radius:20px; box-shadow:0 12px 48px -8px rgba(0,0,0,.25); font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif; display:flex; flex-direction:column; align-items:center; position:relative; transform:translateY(8px); animation:cardIn .5s cubic-bezier(.16,.8,.34,1) both; }
    .login-logo { max-width:80px; height:auto; margin:0 0 20px; display:block; filter:drop-shadow(0 2px 4px rgba(0,0,0,.15)); }
    .login-title { color:#008080; font-size:24px; font-weight:600; margin:0 0 8px; letter-spacing:.5px; }
    .login-subtitle { color:#555; font-size:15px; margin:0 0 28px; line-height:1.4; text-align:center; }
    .login-actions { width:100%; }
    .login-button { width:100%; background:#008080; color:#fff; border:none; padding:14px 26px; font-size:16px; font-weight:500; border-radius:10px; cursor:pointer; display:inline-flex; align-items:center; justify-content:center; gap:8px; letter-spacing:.4px; transition:background .25s ease, transform .25s ease, box-shadow .25s ease; box-shadow:0 4px 16px -4px rgba(0,128,128,.4); }
    .login-button:hover { background:#006d6d; box-shadow:0 6px 20px -6px rgba(0,128,128,.5); transform:translateY(-2px); }
    .login-button:active { background:#005a5a; transform:translateY(0); }
    .login-button:focus-visible { outline:3px solid #34d4d4; outline-offset:2px; }
    .login-powered { font-size:12px; margin:34px 0 0; width:100%; text-align:center; padding-top:18px; color:#008080; font-weight:500; border-top:1px solid #e5e5e5; letter-spacing:.5px; }
    @media (max-width:480px){ .login-card { padding:32px 24px 28px; border-radius:16px; } .login-title { font-size:22px; } .login-subtitle { font-size:14px; margin-bottom:24px; } .login-button { padding:12px 22px; font-size:15px; } }
    @keyframes overlayFade { from { opacity:0; } to { opacity:1; } }
    @keyframes cardIn { from { opacity:0; transform:translateY(24px) scale(.98); } to { opacity:1; transform:translateY(8px) scale(1); } }
    .login-overlay[aria-hidden="false"] .login-card { transform:translateY(0); }
    @media (prefers-reduced-motion:reduce){ .login-overlay, .login-card { animation:none; } .login-button { transition:none; } }
  </style>
</head>
<body>
  <!-- Custom login screen overlay -->
  <div id="custom-login-screen" class="login-overlay" aria-hidden="true">
    <div class="login-card" role="dialog" aria-modal="true" aria-labelledby="cms-login-title">
      <img src="cms.png" alt="Maxnate Logo" class="login-logo" />
      <h1 id="cms-login-title" class="login-title">Welcome to Maxnate CMS</h1>
      <p class="login-subtitle">Please sign in to manage your content</p>
      <div class="login-actions">
        <button id="login-button" class="login-button" aria-label="Sign in with Netlify Identity">
          <span class="login-button__text">Sign in</span>
        </button>
      </div>
      <p class="login-powered">Powered by Maxnate</p>
    </div>
  </div>
  
  <!-- Decap CMS renders here -->
  <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
  
  <!-- Netlify Identity redirect handling -->
  <script>
    // Wait for Netlify Identity to load
    window.addEventListener('load', function() {
      const customLoginScreen = document.getElementById('custom-login-screen');
      const loginButton = document.getElementById('login-button');
      const showOverlay = () => { customLoginScreen.style.display = 'flex'; customLoginScreen.setAttribute('aria-hidden','false'); };
      const hideOverlay = () => { customLoginScreen.style.display = 'none'; customLoginScreen.setAttribute('aria-hidden','true'); };

      if (window.netlifyIdentity) {
        window.netlifyIdentity.on('init', user => {
          if (!user) { showOverlay(); } else { hideOverlay(); }
        });

        window.netlifyIdentity.on('login', () => {
          hideOverlay();
          window.netlifyIdentity.close();
        });

        window.netlifyIdentity.on('logout', () => {
          showOverlay();
        });

        if (loginButton) {
          loginButton.addEventListener('click', () => {
            if (window.netlifyIdentity) {
              window.netlifyIdentity.open();
            } else {
              console.error('Netlify Identity not loaded');
            }
          });
        }
      } else {
        console.error('Netlify Identity widget not loaded');
        showOverlay();
      }
    });
  </script>
</body>
</html>
